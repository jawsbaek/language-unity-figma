# Story 1.1: Load Language Pack from Local File

## Status: Ready

## Story
**As a** Designer or UX Writer  
**I want to** load a language pack from a local JSON/YAML file  
**So that** I can use my company's terminology and style rules in Figma

## Epic
Epic 1: Language Pack & Rule Engine (MVP)

## Acceptance Criteria
1. **AC1.1**: User can select a local JSON/YAML file via file picker
   - File picker opens when user clicks "Load Language Pack" button
   - Supports both .json and .yaml/.yml file extensions
   - Shows appropriate file type filters

2. **AC1.2**: Plugin validates the file against the language pack schema
   - File content is parsed and validated against defined schema
   - Schema validation includes required fields: version, locale, terms, rules
   - Validation catches malformed JSON/YAML syntax

3. **AC1.3**: Valid language packs are cached in figma.clientStorage
   - Successfully validated packs are stored locally
   - Cache includes pack metadata (version, locale, timestamp)
   - Cache persists between plugin sessions

4. **AC1.4**: Invalid files show clear error messages with validation details
   - Specific validation errors are displayed to user
   - Error messages include field names and expected formats
   - User can retry with corrected file

5. **AC1.5**: Cached packs persist between plugin sessions
   - Plugin remembers loaded pack on next session
   - User can see currently loaded pack information
   - Option to reload or change pack is available

## Priority
High - Foundation for all other functionality

## Effort Estimate
5 story points

## Dependencies
- Language pack schema definition
- File picker UI component
- Validation library integration

## Tasks / Subtasks
- [ ] **Task 1**: Design and implement language pack schema
  - [ ] Define JSON schema for language pack structure
  - [ ] Include validation rules for required fields
  - [ ] Document schema with examples

- [ ] **Task 2**: Implement file picker UI
  - [ ] Create file picker button in settings panel
  - [ ] Add file type filters for JSON/YAML
  - [ ] Handle file selection and reading

- [ ] **Task 3**: Build validation engine
  - [ ] Integrate JSON schema validation library
  - [ ] Implement YAML parsing support
  - [ ] Create comprehensive error reporting

- [ ] **Task 4**: Implement caching system
  - [ ] Design cache data structure
  - [ ] Implement figma.clientStorage integration
  - [ ] Add cache management (clear, reload)

- [ ] **Task 5**: Create error handling and user feedback
  - [ ] Design error message UI components
  - [ ] Implement validation error display
  - [ ] Add success confirmation feedback

- [ ] **Task 6**: Add unit tests
  - [ ] Test schema validation with valid/invalid files
  - [ ] Test caching functionality
  - [ ] Test error handling scenarios

## Definition of Done
- [ ] File picker allows selection of JSON/YAML files
- [ ] Schema validation works correctly for all test cases
- [ ] Valid packs are cached and persist between sessions
- [ ] Clear error messages for all validation failures
- [ ] Unit tests pass with >90% coverage
- [ ] UI follows Figma plugin design guidelines
- [ ] Performance acceptable for typical language pack sizes (< 1MB)

## Notes
- Language pack schema should be extensible for future features
- Consider supporting both local file and URL sources in UI design
- Error messages should be helpful for non-technical users
- Cache should include version information for future update detection
